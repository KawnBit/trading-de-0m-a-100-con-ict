<!DOCTYPE html>
<html lang="es" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KawnBit Magazine | Capítulo 16: Temporalidades en el Trading</title>
    <meta name="description"
        content="Guía completa sobre las temporalidades (time frames) en el trading, análisis desde M1 hasta Mensual, fractalidad, timing de cierre, sesiones y análisis Top-Down.">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Montserrat:wght@400;600;700;800;900&display=swap"
        rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Chart.js for improved visuals -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        kawn: {
                            light: '#ccfbf1', // Teal 100
                            base: '#14b8a6',  // Teal 500
                            dark: '#0f766e',  // Teal 700
                            deep: '#134e4a',  // Teal 900
                            accent: '#0d9488' // Teal 600
                        },
                        slate: {
                            800: '#1e293b',
                            900: '#0f172a',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Montserrat', 'sans-serif'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'expand': 'expandHeight 0.5s ease-out forwards',
                        'wick-growth': 'wickGrowth 2s infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        expandHeight: {
                            '0%': { height: '0', opacity: '0' },
                            '100%': { height: 'auto', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Styles for Magazine Feel */
        body {
            background-color: #f8fafc;
            color: #334155;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        th {
            font-family: 'Montserrat', sans-serif;
        }

        p,
        li,
        td {
            font-family: 'Inter', sans-serif;
            line-height: 1.75;
        }

        strong {
            color: #0f766e;
            /* kawn-dark */
            font-weight: 700;
        }

        /* Hero Section Gradient */
        .hero-gradient {
            background: linear-gradient(135deg, #0f172a 0%, #134e4a 100%);
        }

        /* Chart/Visual Container Styles */
        .visual-container {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            margin: 2rem 0;
            overflow: hidden;
            position: relative;
        }

        .visual-title {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            color: #0f766e;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }

        /* Blockquotes */
        .highlight-quote {
            border-left: 4px solid #14b8a6;
            background-color: #f0fdfa;
            padding: 1.5rem;
            font-style: italic;
            color: #134e4a;
            border-radius: 0 0.5rem 0.5rem 0;
            margin: 2rem 0;
        }

        /* Buttons & Interactive Elements */
        .tab-btn {
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            background-color: #0f766e;
            color: white;
            border-color: #0f766e;
        }

        /* Range Slider Styling */
        input[type=range] {
            -webkit-appearance: none;
            appearance: none;
            background: transparent;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #14b8a6;
            cursor: pointer;
            margin-top: -8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #cbd5e1;
            border-radius: 2px;
        }

        /* AI Chat Styles */
        .ai-message {
            margin-bottom: 1rem;
            padding: 1rem;
            border-radius: 0.75rem;
            font-size: 0.9rem;
            max-width: 85%;
            animation: fadeIn 0.3s ease-out;
            word-wrap: break-word;
        }

        .ai-message.user {
            background-color: #f1f5f9;
            color: #334155;
            border-bottom-right-radius: 0;
            margin-left: auto;
        }

        .ai-message.bot {
            background-color: #ccfbf1;
            color: #0f766e;
            border-bottom-left-radius: 0;
            margin-right: auto;
            border: 1px solid #99f6e4;
        }

        .typing-indicator span {
            display: inline-block;
            width: 6px;
            height: 6px;
            background-color: #0f766e;
            border-radius: 50%;
            animation: typing 1s infinite;
            margin: 0 2px;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        /* Interactive Card States */
        .profile-card {
            transition: all 0.3s ease;
        }

        .profile-card.highlight {
            border-color: #14b8a6;
            background-color: #f0fdfa;
            transform: scale(1.02);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .profile-card.dimmed {
            opacity: 0.5;
            filter: grayscale(0.5);
        }

        /* Fractal Visualization Styles */
        .candle-box {
            transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            cursor: pointer;
        }

        .candle-box:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
        }

        .fractal-layer {
            animation: fadeIn 0.8s ease-out;
        }

        /* Candle Simulator Styles */
        .candle-body {
            transition: height 0.3s ease, background-color 0.3s ease, top 0.3s ease;
        }

        .candle-wick {
            transition: all 0.3s ease;
        }
    </style>
</head>

<body class="antialiased">

    <nav class="sticky top-0 z-50 bg-white/95 backdrop-blur-md border-b border-slate-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <div class="flex items-center flex-shrink-0 mr-6">
                    <div
                        class="h-12 w-12 bg-gradient-to-br from-kawn-dark to-kawn-base rounded-lg shadow-sm flex items-center justify-center text-white font-bold text-xl">
                        K</div>
                    <span class="ml-3 font-display font-bold text-slate-800 text-xl hidden md:block">KAWNBIT</span>
                </div>

                <div class="hidden lg:flex space-x-4">
                    <a href="#intro"
                        class="text-slate-500 hover:text-kawn-base font-medium transition-colors text-[11px] uppercase tracking-wider">Intro</a>
                    <a href="#fractalidad"
                        class="text-slate-500 hover:text-kawn-base font-medium transition-colors text-[11px] uppercase tracking-wider font-bold text-kawn-deep">Fractal</a>
                    <a href="#cierre-vela"
                        class="text-slate-500 hover:text-kawn-base font-medium transition-colors text-[11px] uppercase tracking-wider font-bold text-red-600">Timing</a>
                    <a href="#analisis"
                        class="text-slate-500 hover:text-kawn-base font-medium transition-colors text-[11px] uppercase tracking-wider">Análisis</a>
                    <a href="#sesiones"
                        class="text-slate-500 hover:text-kawn-base font-medium transition-colors text-[11px] uppercase tracking-wider">Sesiones</a>
                    <a href="#correlacion"
                        class="text-slate-500 hover:text-kawn-base font-medium transition-colors text-[11px] uppercase tracking-wider">Factores</a>
                    <a href="#perfiles"
                        class="text-slate-500 hover:text-kawn-base font-medium transition-colors text-[11px] uppercase tracking-wider">Perfiles</a>
                    <a href="#ai-lab"
                        class="text-kawn-base hover:text-kawn-dark font-bold transition-colors text-[11px] uppercase tracking-wider flex items-center"><i
                            data-lucide="sparkles" class="w-3 h-3 mr-1"></i> AI</a>
                </div>
            </div>
        </div>
    </nav>

    <section class="hero-gradient relative text-white py-24 overflow-hidden">
        <div class="absolute inset-0 opacity-10 mix-blend-overlay">
            <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
                        <path d="M 40 0 L 0 0 0 40" fill="none" stroke="white" stroke-width="1" />
                    </pattern>
                </defs>
                <rect width="100%" height="100%" fill="url(#grid)" />
            </svg>
        </div>
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center">
            <span
                class="inline-block py-1 px-3 rounded-full bg-kawn-light/20 text-kawn-light text-xs font-bold uppercase tracking-wider mb-6 backdrop-blur-sm">Fundamentos
                del Trading Institucional</span>
            <h1 class="text-4xl md:text-6xl font-black tracking-tight leading-tight mb-6">
                Capítulo 16: Temporalidades y Fractalidad
            </h1>
            <p class="text-xl text-slate-200 font-light max-w-2xl mx-auto leading-relaxed">
                Domina el tiempo en los mercados. Desde la estructura fractal y el timing de cierre hasta el análisis
                Top-Down. Entiende el "cuándo" detrás del "por qué".
            </p>
        </div>
    </section>

    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16">

        <!-- INTRODUCCION: GRAFICO INTERACTIVO DE ZOOM -->
        <section id="intro" class="mb-16 scroll-mt-24">
            <div class="flex items-center mb-8">
                <i data-lucide="clock" class="w-8 h-8 text-kawn-base mr-4"></i>
                <h2 class="text-3xl font-bold text-slate-900">Introducción: La Perspectiva Temporal</h2>
            </div>

            <p class="mb-4 text-lg leading-relaxed font-medium text-slate-700">
                En trading, la <strong>temporalidad</strong> (o <em>time frame</em>) se refiere al intervalo de tiempo
                que representa cada vela o barra en un gráfico.
            </p>
            <p class="mb-4">
                Por ejemplo, en un gráfico de 1 hora (H1) cada vela muestra la acción del precio durante una hora; en
                uno diario, cada vela corresponde a un día completo. Existen temporalidades estándar ampliamente
                utilizadas (1 minuto, 5 minutos, 15 minutos, 1 hora, 4 horas, 1 día, 1 semana, 1 mes, etc.), aunque
                técnicamente cualquier periodo es posible.
            </p>

            <!-- INTERACTIVE VISUAL 1 -->
            <div class="visual-container bg-slate-50 ring-1 ring-slate-200">
                <div class="flex justify-between items-start mb-4">
                    <div class="visual-title mb-0">
                        <i data-lucide="zoom-in" class="w-5 h-5 mr-2"></i> Laboratorio Interactivo: El Efecto "Zoom"
                    </div>
                    <span class="text-xs bg-kawn-light text-kawn-dark px-2 py-1 rounded font-bold">Interactivo</span>
                </div>

                <p class="text-sm mb-6 text-slate-600">
                    Desliza el control para cambiar la temporalidad. Observa cómo el "ruido" aumenta a medida que bajas
                    de temporalidad (zoom in).
                </p>

                <div
                    class="relative h-64 w-full bg-white rounded-lg border border-slate-200 shadow-inner mb-6 overflow-hidden">
                    <canvas id="zoomChart" class="w-full h-full"></canvas>
                    <div id="zoomLabel"
                        class="absolute top-4 right-4 bg-slate-900 text-white px-3 py-1 rounded font-mono text-sm shadow-lg z-10">
                        Diario (D1)
                    </div>
                </div>

                <div class="flex items-center gap-4 px-4">
                    <span class="text-xs font-bold text-slate-400 uppercase">Largo Plazo (MN)</span>
                    <input type="range" min="1" max="100" value="20"
                        class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer" id="timeframeSlider"
                        aria-label="Control de temporalidad">
                    <span class="text-xs font-bold text-red-400 uppercase">Corto Plazo (M1)</span>
                </div>
            </div>

            <p class="mb-4">
                Elegir una temporalidad u otra <strong>condiciona la interpretación del movimiento del precio</strong>:
                es totalmente posible que un activo parezca alcista en un marco temporal corto pero bajista en uno largo
                al mismo tiempo.
            </p>
            <p class="mb-4">
                La importancia estratégica de las temporalidades radica en que <strong>afectan prácticamente todos los
                    aspectos de la operativa</strong>. El marco temporal influye en el número de operaciones que
                tomarás, la duración típica de cada trade, la volatilidad que experimentarás, las herramientas o
                indicadores más útiles y hasta la gestión emocional que necesitas.
            </p>
            <div class="highlight-quote">
                <p class="mb-2">
                    Un marco temporal inapropiado puede dificultar alcanzar consistencia o reducir la rentabilidad de un
                    trader.
                </p>
                <p class="text-sm">
                    Por tanto, escoger la temporalidad adecuada es crucial: debe adaptarse a tu estilo de vida, tu
                    personalidad y tus objetivos financieros.
                </p>
            </div>
        </section>

        <!-- SECTION: FRACTALIDAD -->
        <section id="fractalidad" class="mb-16 scroll-mt-24">
            <div class="flex items-center mb-8">
                <i data-lucide="git-fork" class="w-8 h-8 text-kawn-base mr-4"></i>
                <h2 class="text-3xl font-bold text-slate-900">La Fractalidad del Mercado</h2>
            </div>

            <p class="mb-6">
                Para comprender verdaderamente las temporalidades, debes internalizar un concepto clave: <strong>el
                    mercado es fractal</strong>. Esto significa que los mismos patrones y estructuras que ves en un
                gráfico mensual ocurren idénticamente en un gráfico de 1 minuto, solo que a diferente escala y
                velocidad.
            </p>
            <p class="mb-6">
                Una sola vela "sólida" en una temporalidad alta (como Diario) es, en realidad, una tendencia completa o
                una compleja batalla de precios en una temporalidad menor (como H1 o M15).
            </p>

            <!-- INTERACTIVE VISUAL: CANDLE MICROSCOPE -->
            <div class="visual-container bg-slate-900 text-white border-slate-700">
                <div class="visual-title text-kawn-light mb-2">
                    <i data-lucide="microscope" class="w-5 h-5 mr-2"></i> Microscopio de Velas: La Estructura Interna
                </div>
                <p class="text-sm text-slate-400 mb-6">Haz clic en la vela para "romperla" y ver su estructura interna
                    en una temporalidad menor.</p>

                <!-- Stage 1: The Big Candle (Daily) -->
                <div id="fractal-stage-1" class="fractal-layer flex flex-col items-center justify-center py-8">
                    <div class="text-xs font-bold text-slate-400 mb-4 uppercase tracking-widest">Gráfico Diario (D1)
                    </div>
                    <button onclick="revealFractal(2)"
                        class="candle-box w-16 h-48 bg-green-500 relative rounded-sm flex items-center justify-center group focus:outline-none focus:ring-2 focus:ring-white">
                        <div class="absolute -top-12 w-1 h-12 bg-green-500"></div> <!-- Wick Up -->
                        <div class="absolute -bottom-12 w-1 h-12 bg-green-500"></div> <!-- Wick Down -->
                        <span
                            class="text-green-900 font-bold opacity-0 group-hover:opacity-100 transition-opacity text-xs">CLICK</span>
                    </button>
                    <p class="mt-8 text-center text-sm text-green-400">Una vela alcista fuerte.<br>¿Qué hay dentro?</p>
                </div>

                <!-- Stage 2: The Structure (H1) -->
                <div id="fractal-stage-2" class="fractal-layer hidden flex-col items-center justify-center py-8">
                    <div class="text-xs font-bold text-slate-400 mb-4 uppercase tracking-widest">Gráfico 1 Hora (H1) -
                        Interior de D1</div>
                    <div
                        class="flex items-end h-64 gap-1 p-4 border-b border-l border-slate-600 relative w-full justify-center">
                        <div class="w-4 bg-red-500 h-10 mb-10"></div>
                        <div class="w-4 bg-green-500 h-16 mb-8"></div>
                        <div class="w-4 bg-green-500 h-24 mb-12"></div>
                        <div class="w-4 bg-red-500 h-8 mb-24"></div> <!-- Pullback -->
                        <div class="w-4 bg-green-500 h-20 mb-20"></div>
                        <div class="w-4 bg-green-500 h-32 mb-28"></div>
                        <button onclick="revealFractal(3)"
                            class="w-6 bg-green-500 h-40 mb-32 border-2 border-white cursor-pointer hover:bg-green-400 relative group focus:outline-none focus:ring-2 focus:ring-white">
                            <span
                                class="absolute -top-8 left-0 text-[10px] w-full text-center text-white opacity-0 group-hover:opacity-100">CLICK</span>
                        </button> <!-- The breakout candle to zoom in again -->
                        <div class="w-4 bg-green-500 h-12 mb-52"></div>

                        <svg class="absolute inset-0 w-full h-full pointer-events-none opacity-30">
                            <path d="M180,200 L220,150 L260,100 L280,130 L320,80 L350,50" fill="none" stroke="white"
                                stroke-width="2" stroke-dasharray="5,5" />
                        </svg>
                    </div>
                    <div class="flex justify-between w-full px-12 mt-4">
                        <button onclick="resetFractal()" class="text-xs text-slate-500 hover:text-white underline">←
                            Volver a D1</button>
                        <p class="text-sm text-kawn-light">Vemos una tendencia clara con impulsos y retrocesos.</p>
                    </div>
                </div>

                <!-- Stage 3: The Noise/Detail (M5) -->
                <div id="fractal-stage-3" class="fractal-layer hidden flex-col items-center justify-center py-8">
                    <div class="text-xs font-bold text-slate-400 mb-4 uppercase tracking-widest">Gráfico 5 Minutos (M5)
                        - Detalle</div>
                    <div class="w-full h-48 bg-slate-800 rounded p-2 relative overflow-hidden">
                        <canvas id="fractalM5Chart" class="w-full h-full"></canvas>
                    </div>
                    <div class="flex justify-between w-full mt-4">
                        <button onclick="revealFractal(2)" class="text-xs text-slate-500 hover:text-white underline">←
                            Volver a H1</button>
                        <p class="text-sm text-red-300">Aquí vemos la "lucha" tick a tick: Ruido y volatilidad.</p>
                    </div>
                </div>
            </div>

            <p class="mt-6 text-sm italic text-slate-500 border-l-4 border-slate-300 pl-4">
                "Lo que parece una línea recta en Mensual, es una montaña rusa emocional en 5 minutos."
            </p>
        </section>

        <!-- SECTION: CIERRE DE VELA / TIMING -->
        <section id="cierre-vela" class="mb-16 scroll-mt-24">
            <div class="flex items-center mb-8">
                <i data-lucide="hourglass" class="w-8 h-8 text-kawn-base mr-4"></i>
                <h2 class="text-3xl font-bold text-slate-900">El Engaño de la Vela Viva (Timing)</h2>
            </div>

            <p class="mb-4">
                Un error común en principiantes es operar en base a lo que la vela "está haciendo" y no lo que "ha
                hecho". <strong>Una vela no es información confirmada hasta que cierra</strong>.
            </p>
            <p class="mb-6">
                La "Trampa del Tiempo Restante" ocurre cuando una vela parece una ruptura sólida en el minuto 50 (de una
                hora), pero se revierte completamente en los últimos 10 minutos, dejando atrapados a los traders
                impacientes.
            </p>

            <div class="visual-container bg-slate-50 border-l-4 border-red-500">
                <div class="visual-title text-red-700 mb-2">
                    <i data-lucide="alert-octagon" class="w-5 h-5 mr-2"></i> Simulador: La Trampa de la Formación
                </div>
                <p class="text-sm text-slate-600 mb-6">Mueve el deslizador para avanzar el tiempo de la vela. Mira cómo
                    cambia la historia.</p>

                <div class="flex flex-col md:flex-row items-center gap-12 justify-center py-6">
                    <!-- Dynamic Candle -->
                    <div class="relative w-24 h-64 bg-slate-200 rounded flex items-center justify-center">
                        <div class="w-[2px] h-full bg-slate-400 absolute"></div> <!-- Wick Background -->
                        <div id="sim-candle-body" class="candle-body w-12 bg-green-500 absolute bottom-1/2 rounded-sm"
                            style="height: 0px;"></div>
                        <div id="sim-candle-top-wick" class="candle-wick w-[2px] bg-green-500 absolute"
                            style="bottom: 50%; height: 0px;"></div>
                    </div>

                    <!-- Controls & Feedback -->
                    <div class="flex-1 w-full max-w-md">
                        <div class="flex justify-between text-xs font-bold text-slate-500 mb-2 uppercase">
                            <span>Apertura (Min 0)</span>
                            <span id="timer-display" class="text-xl text-slate-800">Min: 00</span>
                            <span>Cierre (Min 60)</span>
                        </div>
                        <input type="range" min="0" max="60" value="0" id="candleSlider" class="w-full mb-6"
                            aria-label="Control de tiempo de vela">

                        <div id="candle-narrative"
                            class="bg-white p-4 rounded shadow border border-slate-200 text-center">
                            <strong class="text-slate-800 text-lg block mb-1">La vela abre.</strong>
                            <p class="text-sm text-slate-500">Esperando movimiento...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ANALISIS: TABS INTERACTIVAS -->
        <section id="analisis" class="mb-16 scroll-mt-24">
            <div class="flex items-center mb-8">
                <i data-lucide="bar-chart" class="w-8 h-8 text-kawn-base mr-4"></i>
                <h2 class="text-3xl font-bold text-slate-900">Análisis de las Temporalidades más Utilizadas</h2>
            </div>

            <p class="mb-6">
                La mayoría de traders utiliza temporalidades estándar que van desde <strong>intradía</strong> (marcos de
                minutos a horas) hasta <strong>largo plazo</strong> (marcos diarios o superiores).
            </p>
            <p class="mb-8 font-medium">
                Una idea general clave: <strong>las temporalidades bajas muestran mayor detalle pero también más
                    “ruido”</strong>, mientras que las altas ofrecen una visión más filtrada y estable de las
                tendencias.
            </p>

            <!-- INTERACTIVE TABS CONTAINER -->
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                <div class="flex flex-wrap border-b border-slate-200">
                    <button onclick="switchTab('short')"
                        class="tab-btn active flex-1 py-4 px-6 text-sm font-bold uppercase tracking-wider border-b-2 border-transparent text-slate-500 hover:text-kawn-base"
                        id="btn-short">
                        <i data-lucide="zap" class="inline w-4 h-4 mr-2 mb-1"></i>Ultra Corto (M1-M5)
                    </button>
                    <button onclick="switchTab('intra')"
                        class="tab-btn flex-1 py-4 px-6 text-sm font-bold uppercase tracking-wider border-b-2 border-transparent text-slate-500 hover:text-kawn-base"
                        id="btn-intra">
                        <i data-lucide="activity" class="inline w-4 h-4 mr-2 mb-1"></i>Intradía (M15-H1)
                    </button>
                    <button onclick="switchTab('long')"
                        class="tab-btn flex-1 py-4 px-6 text-sm font-bold uppercase tracking-wider border-b-2 border-transparent text-slate-500 hover:text-kawn-base"
                        id="btn-long">
                        <i data-lucide="trending-up" class="inline w-4 h-4 mr-2 mb-1"></i>Swing (H4-MN)
                    </button>
                </div>

                <div class="p-6 md:p-8 bg-slate-50 min-h-[400px]">
                    <!-- CONTENT: SHORT TERM -->
                    <div id="content-short" class="tab-content animate-fade-in block">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="bg-white p-6 rounded-lg shadow-sm border-t-4 border-red-500">
                                <h4 class="font-bold text-lg mb-2 text-red-700">Gráfico de 1 minuto (M1)</h4>
                                <p class="text-sm mb-3">Es el dominio del <strong>scalping extremo</strong> y del
                                    trading algorítmico. Muestra los movimientos más diminutos y el detalle máximo.</p>
                                <ul class="custom-list space-y-2 text-sm">
                                    <li class="flex items-start"><i data-lucide="check"
                                            class="w-4 h-4 mr-2 mt-1 text-green-500"></i><span>Multitud de oportunidades
                                            intradía y feedback rápido.</span></li>
                                    <li class="flex items-start"><i data-lucide="x"
                                            class="w-4 h-4 mr-2 mt-1 text-red-500"></i><span><strong>Ruido y señales
                                                falsas en abundancia</strong>. Contiene mucho "azar del mercado".</span>
                                    </li>
                                    <li class="flex items-start"><i data-lucide="x"
                                            class="w-4 h-4 mr-2 mt-1 text-red-500"></i><span>Exigencia mental y estrés
                                            extremo. Ritmo frenético.</span></li>
                                    <li class="flex items-start"><i data-lucide="x"
                                            class="w-4 h-4 mr-2 mt-1 text-red-500"></i><span>Costos proporcionales
                                            elevados (spread/comisiones impactan mucho).</span></li>
                                </ul>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-t-4 border-orange-500">
                                <h4 class="font-bold text-lg mb-2 text-orange-700">Gráfico de 5 minutos (M5)</h4>
                                <p class="text-sm mb-3">Favorito de scalpers y day traders agresivos. Ligeramente más
                                    "estable" que M1, un compromiso entre detalle y locura.</p>
                                <ul class="custom-list space-y-2 text-sm">
                                    <li class="flex items-start"><i data-lucide="check"
                                            class="w-4 h-4 mr-2 mt-1 text-green-500"></i><span>Muchas oportunidades con
                                            algo más de filtro que M1.</span></li>
                                    <li class="flex items-start"><i data-lucide="check"
                                            class="w-4 h-4 mr-2 mt-1 text-green-500"></i><span>Decisiones un poco más
                                            meditadas (trades de 15-60 mins).</span></li>
                                    <li class="flex items-start"><i data-lucide="x"
                                            class="w-4 h-4 mr-2 mt-1 text-red-500"></i><span>Todavía considerable ruido
                                            de mercado y necesidad de atención constante.</span></li>
                                    <li class="flex items-start"><i data-lucide="x"
                                            class="w-4 h-4 mr-2 mt-1 text-red-500"></i><span>Menor movimiento por trade,
                                            requiere muchas operaciones exitosas.</span></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- CONTENT: INTRADAY -->
                    <div id="content-intra" class="tab-content animate-fade-in hidden">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="bg-white p-6 rounded-lg shadow-sm border-t-4 border-yellow-500">
                                <h4 class="font-bold text-lg mb-2 text-yellow-700">Gráfico de 15 minutos (M15)</h4>
                                <p class="text-sm mb-3">Popular para <strong>day trading clásico</strong> y timing de
                                    entradas. Un término medio entre rapidez y fiabilidad.</p>
                                <ul class="custom-list space-y-2 text-sm">
                                    <li class="flex items-start"><i data-lucide="check"
                                            class="w-4 h-4 mr-2 mt-1 text-green-500"></i><span>Buen balance señal/ruido
                                            para intradía. Señales más fiables que M1/M5.</span></li>
                                    <li class="flex items-start"><i data-lucide="check"
                                            class="w-4 h-4 mr-2 mt-1 text-green-500"></i><span>Varias oportunidades al
                                            día (2-5) sin saturar.</span></li>
                                    <li class="flex items-start"><i data-lucide="check"
                                            class="w-4 h-4 mr-2 mt-1 text-green-500"></i><span>Compatible con análisis
                                            de múltiples marcos (puente entre H1/H4 y ejecución).</span></li>
                                    <li class="flex items-start"><i data-lucide="x"
                                            class="w-4 h-4 mr-2 mt-1 text-red-500"></i><span>Demanda disponibilidad
                                            intradía y atención durante la sesión.</span></li>
                                </ul>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-t-4 border-kawn-base">
                                <h4 class="font-bold text-lg mb-2 text-kawn-dark">Gráfico de 1 hora (H1)</h4>
                                <p class="text-sm mb-3">Pilar del análisis técnico. Usado para intradía pausado o swing
                                    trading corto. Buen equilibrio para principiantes.</p>
                                <ul class="custom-list space-y-2 text-sm">
                                    <li class="flex items-start"><i data-lucide="check"
                                            class="w-4 h-4 mr-2 mt-1 text-green-500"></i><span><strong>Alta claridad
                                                estructural</strong>. Filtra la mayor parte del ruido menor.</span></li>
                                    <li class="flex items-start"><i data-lucide="check"
                                            class="w-4 h-4 mr-2 mt-1 text-green-500"></i><span>Más tiempo para
                                            planificar, disminuye el estrés y la impulsividad.</span></li>
                                    <li class="flex items-start"><i data-lucide="check"
                                            class="w-4 h-4 mr-2 mt-1 text-green-500"></i><span>Señales más fiables, los
                                            niveles técnicos son más respetados.</span></li>
                                    <li class="flex items-start"><i data-lucide="x"
                                            class="w-4 h-4 mr-2 mt-1 text-red-500"></i><span>Requiere aguantar
                                            operaciones horas o incluso overnight.</span></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- CONTENT: LONG TERM -->
                    <div id="content-long" class="tab-content animate-fade-in hidden">
                        <div class="grid md:grid-cols-3 gap-6">
                            <div class="bg-white p-6 rounded-lg shadow-sm border-t-4 border-blue-400">
                                <h4 class="font-bold text-lg mb-2 text-blue-600">4 Horas (H4)</h4>
                                <p class="text-sm mb-3">Apreciado para <strong>swing trading ágil</strong>. Ideal para
                                    principiantes por su fiabilidad y menor requerimiento de tiempo.</p>
                                <p class="text-xs text-slate-500 mt-2 border-t pt-2"><i data-lucide="check-circle"
                                        class="inline w-3 h-3 text-kawn-base mr-1"></i> Tendencias definidas, mayor
                                    beneficio por trade, permite revisar pocas veces al día.</p>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-t-4 border-blue-600">
                                <h4 class="font-bold text-lg mb-2 text-blue-800">Diario (D1)</h4>
                                <p class="text-sm mb-3">Para <strong>swing trading lento</strong> e inversores. Elimina
                                    casi todo el ruido intradía. Señales muy potentes y fiables.</p>
                                <p class="text-xs text-slate-500 mt-2 border-t pt-2"><i data-lucide="check-circle"
                                        class="inline w-3 h-3 text-kawn-base mr-1"></i> Grandes recorridos de precio,
                                    bajísima presión emocional, ideal para compaginar con trabajo.</p>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-t-4 border-blue-900 bg-blue-50">
                                <h4 class="font-bold text-lg mb-2 text-blue-900">Semanal (W1) y MN</h4>
                                <p class="text-sm mb-3">Visión de <strong>inversores de largo plazo</strong> y
                                    macroeconomía. Identifican la tendencia primaria y ciclos económicos.</p>
                                <p class="text-xs text-slate-500 mt-2 border-t border-blue-200 pt-2"><i
                                        data-lucide="alert-triangle" class="inline w-3 h-3 text-yellow-600 mr-1"></i>
                                    Muy pocas señales al año. Requiere paciencia férrea.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION: SESIONES -->
        <section id="sesiones" class="mb-16 scroll-mt-24">
            <div class="flex items-center mb-8">
                <i data-lucide="globe" class="w-8 h-8 text-kawn-base mr-4"></i>
                <h2 class="text-3xl font-bold text-slate-900">Cronobiología: El Contexto de la Sesión</h2>
            </div>
            <p class="mb-4">
                No todas las horas son iguales. Una vela de 5 minutos (M5) en la sesión Asiática suele tener poco
                volumen, mientras que una M5 en la apertura de Londres puede mover 50 pips. <strong>Debes ajustar tu
                    temporalidad al ritmo de la sesión actual</strong>.
            </p>

            <div class="visual-container bg-slate-800 text-white">
                <div class="visual-title text-kawn-light mb-4">
                    <i data-lucide="map" class="w-5 h-5 mr-2"></i> Monitor de Sesiones de Mercado
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <button onclick="setSession('asia')"
                        class="p-4 rounded-lg border-2 border-slate-600 hover:bg-slate-700 hover:border-blue-400 transition-all text-left group"
                        id="btn-asia">
                        <div class="text-xs font-bold text-slate-400 uppercase mb-1 group-hover:text-white">Sesión
                            Asiática</div>
                        <div class="text-xl font-black text-white">Tokyo / Sydney</div>
                        <div class="mt-2 text-[10px] bg-slate-900 inline-block px-2 py-1 rounded text-slate-300">Rango /
                            Consolidación</div>
                    </button>
                    <button onclick="setSession('london')"
                        class="p-4 rounded-lg border-2 border-kawn-base bg-slate-700 shadow-lg shadow-kawn-base/20 transition-all text-left"
                        id="btn-london">
                        <div class="text-xs font-bold text-kawn-light uppercase mb-1">Sesión Europea</div>
                        <div class="text-xl font-black text-white">London / Frankfurt</div>
                        <div class="mt-2 text-[10px] bg-kawn-deep inline-block px-2 py-1 rounded text-white font-bold">
                            Volatilidad / Ruptura</div>
                    </button>
                    <button onclick="setSession('ny')"
                        class="p-4 rounded-lg border-2 border-slate-600 hover:bg-slate-700 hover:border-orange-400 transition-all text-left group"
                        id="btn-ny">
                        <div class="text-xs font-bold text-slate-400 uppercase mb-1 group-hover:text-white">Sesión
                            Americana</div>
                        <div class="text-xl font-black text-white">New York</div>
                        <div class="mt-2 text-[10px] bg-slate-900 inline-block px-2 py-1 rounded text-slate-300">
                            Reversión / Tendencia</div>
                    </button>
                </div>

                <div id="session-details" class="bg-slate-900 p-6 rounded-xl border border-slate-700">
                    <h4 class="text-lg font-bold text-kawn-base mb-2">London Open (Impacto Alto)</h4>
                    <p class="text-sm text-slate-300 mb-4">Es el momento de mayor volumen mundial. Las tendencias del
                        día suelen iniciarse aquí.</p>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-slate-800 p-3 rounded border border-slate-600">
                            <span class="text-xs font-bold text-slate-400 block mb-1">Temporalidad Recomendada</span>
                            <span class="text-green-400 font-bold">M15 y H1</span>
                            <p class="text-[10px] text-slate-500 mt-1">Busca rupturas de rangos asiáticos.</p>
                        </div>
                        <div class="bg-slate-800 p-3 rounded border border-slate-600">
                            <span class="text-xs font-bold text-slate-400 block mb-1">Pares Recomendados</span>
                            <span class="text-blue-300 font-bold">GBP/USD, EUR/USD</span>
                            <p class="text-[10px] text-slate-500 mt-1">Máxima liquidez.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- PERFILES: QUIZ INTERACTIVO -->
        <section id="perfiles" class="mb-16 scroll-mt-24">
            <div class="flex items-center mb-8">
                <i data-lucide="users" class="w-8 h-8 text-kawn-base mr-4"></i>
                <h2 class="text-3xl font-bold text-slate-900">¿Cómo elegir según tu perfil de Trader?</h2>
            </div>
            <p class="mb-6">
                La elección del marco temporal óptimo está estrechamente ligada al estilo de trading, personalidad,
                tiempo disponible y tolerancia al riesgo.
            </p>

            <div class="bg-slate-100 p-6 rounded-xl mb-8 border border-slate-300">
                <h3 class="font-bold text-slate-700 mb-4 flex items-center"><i data-lucide="help-circle"
                        class="w-5 h-5 mr-2"></i> Encuentra tu Perfil</h3>
                <div class="flex flex-wrap gap-4 mb-4">
                    <button onclick="highlightProfile('scalper')"
                        class="bg-white hover:bg-red-50 text-slate-600 font-medium py-2 px-4 rounded shadow-sm border border-slate-200 text-sm transition-colors">
                        "Tengo mucho tiempo y amo la adrenalina"
                    </button>
                    <button onclick="highlightProfile('day')"
                        class="bg-white hover:bg-orange-50 text-slate-600 font-medium py-2 px-4 rounded shadow-sm border border-slate-200 text-sm transition-colors">
                        "Quiero operar por la mañana y dormir tranquilo"
                    </button>
                    <button onclick="highlightProfile('swing')"
                        class="bg-white hover:bg-kawn-light text-slate-600 font-medium py-2 px-4 rounded shadow-sm border border-slate-200 text-sm transition-colors">
                        "Trabajo todo el día, solo puedo mirar gráficos por la noche"
                    </button>
                    <button onclick="highlightProfile('position')"
                        class="bg-white hover:bg-blue-50 text-slate-600 font-medium py-2 px-4 rounded shadow-sm border border-slate-200 text-sm transition-colors">
                        "Busco crear patrimonio a largo plazo sin estrés"
                    </button>
                </div>
            </div>

            <div class="grid md:grid-cols-4 gap-4" id="profile-grid">
                <!-- Scalper -->
                <div id="card-scalper" class="profile-card bg-white p-5 rounded-xl shadow-sm border-t-4 border-red-500">
                    <div class="bg-red-100 w-10 h-10 rounded-full flex items-center justify-center mb-4">
                        <i data-lucide="zap" class="text-red-600"></i>
                    </div>
                    <h4 class="font-bold text-lg mb-2">Scalpers</h4>
                    <p class="text-xs font-bold text-slate-500 uppercase mb-3">Tolerantes al estrés | Acción constante
                    </p>
                    <p class="text-sm mb-4">Buscan adrenalina y acción constante. Tolerantes al estrés, con excelente
                        capacidad de reacción y dedicación exclusiva mientras operan.</p>
                    <div class="bg-slate-100 p-2 rounded text-center font-bold text-red-700 text-sm">M1, M5</div>
                </div>

                <!-- Day Trader -->
                <div id="card-day" class="profile-card bg-white p-5 rounded-xl shadow-sm border-t-4 border-orange-500">
                    <div class="bg-orange-100 w-10 h-10 rounded-full flex items-center justify-center mb-4">
                        <i data-lucide="sun" class="text-orange-600"></i>
                    </div>
                    <h4 class="font-bold text-lg mb-2">Day Traders</h4>
                    <p class="text-xs font-bold text-slate-500 uppercase mb-3">Disponibilidad Diaria | Balance</p>
                    <p class="text-sm mb-4">Tienen tiempo para seguir el mercado durante el día. Buscan un balance entre
                        cantidad de operaciones y calidad de señales, cerrando todo al terminar la sesión.</p>
                    <div class="bg-slate-100 p-2 rounded text-center font-bold text-orange-700 text-sm">M5, M15, H1
                    </div>
                </div>

                <!-- Swing Trader -->
                <div id="card-swing" class="profile-card bg-white p-5 rounded-xl shadow-sm border-t-4 border-kawn-base">
                    <div class="bg-kawn-light w-10 h-10 rounded-full flex items-center justify-center mb-4">
                        <i data-lucide="briefcase" class="text-kawn-dark"></i>
                    </div>
                    <h4 class="font-bold text-lg mb-2">Swing Traders</h4>
                    <p class="text-xs font-bold text-slate-500 uppercase mb-3">Pacientes | Estratégicos</p>
                    <p class="text-sm mb-4">Valoran la calma y la estrategia. Tienen tolerancia a esperar y ver
                        ganancias o pérdidas flotantes por varios días (overnight). Ideal si tienes otro trabajo.</p>
                    <div class="bg-slate-100 p-2 rounded text-center font-bold text-kawn-deep text-sm">H4, D1</div>
                </div>

                <!-- Position -->
                <div id="card-position"
                    class="profile-card bg-white p-5 rounded-xl shadow-sm border-t-4 border-blue-700">
                    <div class="bg-blue-100 w-10 h-10 rounded-full flex items-center justify-center mb-4">
                        <i data-lucide="anchor" class="text-blue-800"></i>
                    </div>
                    <h4 class="font-bold text-lg mb-2">Inversores</h4>
                    <p class="text-xs font-bold text-slate-500 uppercase mb-3">Alta tolerancia a la espera | Macro</p>
                    <p class="text-sm mb-4">Horizonte de semanas, meses o años. No les preocupa el ruido diario. Se
                        enfocan en las fuerzas macroeconómicas o tesis fundamentales.</p>
                    <div class="bg-slate-100 p-2 rounded text-center font-bold text-blue-900 text-sm">W1, MN</div>
                </div>
            </div>
        </section>

        <!-- TOP DOWN: CALCULADORA DE ALINEACION -->
        <section id="top-down" class="mb-16 scroll-mt-24">
            <div class="flex items-center mb-8">
                <i data-lucide="layers" class="w-8 h-8 text-kawn-base mr-4"></i>
                <h2 class="text-3xl font-bold text-slate-900">Integración: Análisis Top-Down</h2>
            </div>

            <p class="mb-6">
                La integración de múltiples marcos temporales, conocida como <strong>análisis top-down</strong>,
                consiste en examinar el mercado a través de al menos tres “lentes” diferentes (alto, medio y bajo plazo)
                antes de tomar una decisión.
            </p>
            <div class="highlight-quote border-blue-500 bg-blue-50 text-blue-900 mb-8">
                <p class="font-bold mb-1">Regla de Oro:</p>
                <p class="text-sm">Alinear los marcos temporales: asegurarse de que las señales del marco menor van a
                    favor de la tendencia o estructura del marco mayor.</p>
            </div>

            <!-- INTERACTIVE CALCULATOR -->
            <div class="visual-container bg-slate-800 text-white">
                <div class="visual-title text-kawn-light justify-center mb-6">
                    <i data-lucide="calculator" class="w-5 h-5 mr-2"></i> Simulador de Alineación (Triple Pantalla)
                </div>

                <div class="grid md:grid-cols-3 gap-4 text-slate-800">
                    <!-- HTF -->
                    <div class="bg-white p-4 rounded-lg">
                        <div class="text-xs font-bold text-blue-800 mb-1 uppercase">1. Tendencia Mayor (HTF)</div>
                        <select id="sel-htf" class="w-full p-2 border rounded bg-slate-50 font-bold"
                            onchange="calculateTopDown()" aria-label="Seleccionar Tendencia Mayor">
                            <option value="neutral">-- Seleccionar --</option>
                            <option value="bullish">Alcista (Bullish)</option>
                            <option value="bearish">Bajista (Bearish)</option>
                            <option value="range">Rango / Lateral</option>
                        </select>
                        <p class="text-xs text-slate-500 mt-2">Define el sesgo direccional.</p>
                    </div>

                    <!-- MTF -->
                    <div class="bg-white p-4 rounded-lg">
                        <div class="text-xs font-bold text-kawn-deep mb-1 uppercase">2. Estructura Media (MTF)</div>
                        <select id="sel-mtf" class="w-full p-2 border rounded bg-slate-50 font-bold"
                            onchange="calculateTopDown()" aria-label="Seleccionar Estructura Media">
                            <option value="neutral">-- Seleccionar --</option>
                            <option value="align">Alineada (Impulso)</option>
                            <option value="pullback">Retroceso (Pullback)</option>
                            <option value="break">Rompiendo Estructura</option>
                        </select>
                        <p class="text-xs text-slate-500 mt-2">Define la zona operativa.</p>
                    </div>

                    <!-- LTF -->
                    <div class="bg-white p-4 rounded-lg">
                        <div class="text-xs font-bold text-slate-600 mb-1 uppercase">3. Gatillo Menor (LTF)</div>
                        <select id="sel-ltf" class="w-full p-2 border rounded bg-slate-50 font-bold"
                            onchange="calculateTopDown()" aria-label="Seleccionar Gatillo Menor">
                            <option value="neutral">-- Seleccionar --</option>
                            <option value="pattern">Patrón de Entrada Claro</option>
                            <option value="noise">Ruido / Indecisión</option>
                            <option value="against">Señal Contra-Tendencia</option>
                        </select>
                        <p class="text-xs text-slate-500 mt-2">Define el timing preciso.</p>
                    </div>
                </div>

                <div id="td-result"
                    class="mt-6 p-4 rounded-lg bg-slate-700/50 border border-slate-600 text-center transition-all">
                    <p class="text-slate-400 italic">Selecciona las condiciones arriba para ver el análisis.</p>
                </div>

                <p class="text-center mt-6 text-xs text-slate-400">Siempre analiza en orden descendente: de mayor a
                    menor.</p>
            </div>
        </section>

        <section id="peligros" class="mb-16 scroll-mt-24 bg-red-50 p-8 rounded-2xl border border-red-100">
            <div class="flex items-center mb-8">
                <i data-lucide="alert-triangle" class="w-8 h-8 text-red-600 mr-4"></i>
                <h2 class="text-3xl font-bold text-slate-900">Peligros Comunes al ignorar las Temporalidades</h2>
            </div>
            <p class="mb-6">No entender bien las temporalidades conlleva riesgos significativos.</p>

            <div class="space-y-4">
                <div class="flex gap-4 items-start bg-white p-4 rounded-lg shadow-sm">
                    <div class="bg-red-100 p-2 rounded-full shrink-0"><i data-lucide="x-circle"
                            class="text-red-600 w-5 h-5"></i></div>
                    <div>
                        <h4 class="font-bold text-red-700">Entrar en señales falsas por falta de contexto</h4>
                        <p class="text-sm">Operar una señal en un marco bajo (ej. ruptura en M5) sin ver que va en
                            contra de la tendencia principal de un marco alto (ej. H4 bajista).</p>
                    </div>
                </div>
                <div class="flex gap-4 items-start bg-white p-4 rounded-lg shadow-sm">
                    <div class="bg-red-100 p-2 rounded-full shrink-0"><i data-lucide="x-circle"
                            class="text-red-600 w-5 h-5"></i></div>
                    <div>
                        <h4 class="font-bold text-red-700">Mezclar marcos en la gestión (Inconsistencia)</h4>
                        <p class="text-sm">Planificar una operación en diario pero cerrarla por miedo al ver ruido en un
                            gráfico de 5 minutos. Si tu plan es diario, gestiona en diario.</p>
                    </div>
                </div>
                <div class="flex gap-4 items-start bg-white p-4 rounded-lg shadow-sm">
                    <div class="bg-red-100 p-2 rounded-full shrink-0"><i data-lucide="x-circle"
                            class="text-red-600 w-5 h-5"></i></div>
                    <div>
                        <h4 class="font-bold text-red-700">Sobreoperar por mirar temporalidades demasiado bajas</h4>
                        <p class="text-sm">Caer en la adicción de los marcos de M1-M5 pensando que hay más
                            oportunidades, resultando en muchas pérdidas pequeñas por ruido y comisiones.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="consejos" class="mb-16 scroll-mt-24">
            <div class="flex items-center mb-8">
                <i data-lucide="thumbs-up" class="w-8 h-8 text-kawn-base mr-4"></i>
                <h2 class="text-3xl font-bold text-slate-900">Mejores Prácticas Profesionales (Actualizado 2025)</h2>
            </div>

            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white p-6 rounded-xl shadow-sm border-l-4 border-kawn-base">
                    <h4 class="font-bold text-lg mb-3">1. Adapta la temporalidad a tu vida</h4>
                    <p class="text-sm">Si tienes un trabajo de 8 horas, no pretendas hacer scalping. Opta por swing
                        trading en H4 o diario. Conócete a ti mismo y elige un marco que te ponga en ventaja
                        psicológica.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border-l-4 border-kawn-base">
                    <h4 class="font-bold text-lg mb-3">2. Evita los extremos al comenzar</h4>
                    <p class="text-sm">No inicies con scalping ultra corto ni inversiones larguísimas. Temporalidades
                        como <strong>H1 o H4 son ideales para empezar</strong>: equilibrio entre frecuencia y
                        fiabilidad.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border-l-4 border-kawn-base">
                    <h4 class="font-bold text-lg mb-3">3. Usa un conjunto fijo de temporalidades</h4>
                    <p class="text-sm">Sistematiza tu enfoque (ej: Semanal para tendencia, Diario para setups, H4 para
                        entradas). 3 temporalidades suelen bastar; más genera sobrecarga de información.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border-l-4 border-kawn-base">
                    <h4 class="font-bold text-lg mb-3">4. Marca niveles mayores en marcos menores</h4>
                    <p class="text-sm">Dibuja los soportes y resistencias importantes del marco mayor (ej. Diario) y
                        déjalos proyectados en tu gráfico operativo (ej. H1) para no perder el contexto.</p>
                </div>
            </div>
            <div class="mt-8 text-center">
                <p class="text-lg font-bold text-kawn-deep">“Primero domina un gráfico diario o H4 antes de aventurarte
                    en 5 minutos”.</p>
            </div>
        </section>

        <!-- AI LAB: POWERED BY GEMINI -->
        <section id="ai-lab" class="mb-16 scroll-mt-24 bg-slate-50 p-8 rounded-3xl border border-slate-200">
            <div class="flex items-center mb-8">
                <i data-lucide="sparkles" class="w-8 h-8 text-kawn-base mr-4"></i>
                <h2 class="text-3xl font-bold text-slate-900">Laboratorio de Inteligencia KawnBit (Gemini Powered) ✨
                </h2>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">

                <!-- FEATURE 1: CHATBOT -->
                <div
                    class="bg-white rounded-2xl shadow-lg border border-slate-200 overflow-hidden flex flex-col h-[500px]">
                    <div class="bg-gradient-to-r from-kawn-deep to-kawn-dark p-4 flex justify-between items-center">
                        <div class="flex items-center text-white">
                            <i data-lucide="bot" class="w-6 h-6 mr-2"></i>
                            <div>
                                <h3 class="font-bold text-sm">Mentor de Trading IA</h3>
                                <p class="text-[10px] opacity-80">Especialista en Análisis Multi-Temporal</p>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <span class="w-2 h-2 bg-green-400 rounded-full mr-1 animate-pulse"></span>
                            <span class="text-[10px] text-white/80">Online</span>
                        </div>
                    </div>

                    <div id="chat-container" class="flex-1 p-6 overflow-y-auto bg-slate-50 flex flex-col gap-4">
                        <div class="ai-message bot">
                            Hola. Soy tu mentor especializado en temporalidades. Si no dispones de una API Key,
                            funcionaré en modo demo. ✨
                        </div>
                    </div>

                    <div class="p-4 bg-white border-t border-slate-200">
                        <form id="chat-form" class="flex gap-2" onsubmit="handleChatSubmit(event)">
                            <input type="text" id="user-input"
                                class="flex-1 border border-slate-300 rounded-lg px-4 py-2 outline-none focus:border-kawn-base transition-colors text-sm"
                                placeholder="Ej: ¿Qué temporalidad usar si tengo poco tiempo?"
                                aria-label="Escribe tu pregunta para el mentor IA">
                            <button type="submit"
                                class="bg-kawn-dark text-white p-2 rounded-lg hover:bg-kawn-deep transition-colors"
                                aria-label="Enviar pregunta">
                                <i data-lucide="send" class="w-5 h-5"></i>
                            </button>
                        </form>
                    </div>
                </div>

                <div class="flex flex-col gap-6">

                    <!-- FEATURE 2: ANALYZER -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 flex-1 flex flex-col">
                        <h3 class="font-bold text-kawn-deep mb-3 flex items-center"><i data-lucide="microscope"
                                class="mr-2"></i> Analizador de Alineación Temporal</h3>
                        <p class="text-xs text-slate-500 mb-3">Describe tu gráfico (ej: Diario alcista, H4 rango, M15
                            rompiendo) y Gemini evaluará la probabilidad.</p>
                        <textarea id="analyzer-input"
                            class="w-full h-24 border border-slate-200 rounded p-3 text-sm resize-none mb-3 focus:border-kawn-base outline-none"
                            placeholder="Describe tu análisis Top-Down aquí..."
                            aria-label="Descripción del análisis de trading"></textarea>
                        <button onclick="handleAnalyzer()" id="analyzer-btn"
                            class="w-full py-2 bg-slate-800 hover:bg-slate-900 text-white rounded font-bold text-sm flex justify-center items-center gap-2 mb-3 transition-colors">
                            <i data-lucide="sparkles" class="w-4 h-4"></i> Analizar con Gemini ✨
                        </button>
                        <div id="analyzer-result"
                            class="hidden p-3 bg-slate-50 rounded border border-slate-200 text-sm"></div>
                    </div>

                    <!-- FEATURE 3: QUIZ GENERATOR -->
                    <div
                        class="bg-gradient-to-br from-kawn-light/30 to-white p-6 rounded-2xl shadow-sm border border-kawn-base/20 flex-1 flex flex-col justify-center">
                        <h3 class="font-bold text-kawn-deep mb-2 flex items-center"><i data-lucide="award"
                                class="mr-2"></i> Generador de Desafíos</h3>
                        <p class="text-xs text-slate-500 mb-4">Gemini generará una pregunta única sobre este capítulo
                            para ponerte a prueba.</p>
                        <button onclick="handleQuiz()" id="quiz-btn"
                            class="w-full py-3 bg-kawn-base hover:bg-kawn-dark text-white rounded-lg font-bold text-sm flex justify-center items-center gap-2 shadow-md transition-colors">
                            <i data-lucide="zap" class="w-4 h-4"></i> Generar Pregunta Nueva ✨
                        </button>
                        <div id="quiz-container" class="hidden mt-4">
                            <!-- Quiz content injected here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="conclusion" class="mb-16 scroll-mt-24 text-center">
            <h2 class="text-3xl font-bold text-slate-900 mb-6">Conclusión</h2>
            <p class="text-lg font-medium text-slate-700 max-w-3xl mx-auto mb-8">
                Dominar las temporalidades es una habilidad indispensable. El análisis multi-temporal no garantiza el
                éxito en cada trade, pero aumenta drásticamente la probabilidad de estar en sintonía con el mercado en
                diferentes escalas.
            </p>
            <p class="font-bold text-kawn-deep text-xl">
                Aplicar estos principios te permitirá tener una visión 360° del mercado, evitando quedarte “ciego” a la
                mitad del bosque.
            </p>
        </section>

    </main>

    <footer class="bg-slate-900 text-slate-400 py-12">
        <div
            class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center gap-6">
            <div class="flex items-center gap-3">
                <div
                    class="h-10 w-10 bg-gradient-to-br from-kawn-dark to-kawn-base rounded-md opacity-80 flex items-center justify-center text-white font-bold">
                    K</div>
                <div class="flex flex-col">
                    <span class="text-xl font-black text-white tracking-tight leading-none font-display">KAWNBIT</span>
                    <span
                        class="text-[0.6rem] font-bold text-kawn-base uppercase tracking-[0.2em] leading-none mt-1">Quantitative
                        Trading Community</span>
                </div>
            </div>
            <p class="text-sm text-center md:text-right">
                © <span id="current-year">2025</span> KawnBit Magazine. Todos los derechos reservados.<br>
                <span class="text-xs opacity-50">Material educativo sobre Trading Institucional y Temporalidades. No
                    constituye asesoramiento financiero.</span>
            </p>
        </div>
    </footer>

    <script>
        // --- CONFIGURATION ---
        const proxyUrl = "/.netlify/functions/gemini-proxy";

        // --- INIT ---
        document.getElementById('current-year').textContent = new Date().getFullYear();
        lucide.createIcons();
        calculateFactor();

        // --- SAFE HTML SANITIZER ---
        // Previene XSS permitiendo solo negritas básicas
        function safeMarkdown(text) {
            if (!text) return "";
            // 1. Escapar HTML base para evitar inyección de scripts
            let safe = text.replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");

            // 2. Permitir solo negritas (**texto**) y saltos de línea
            safe = safe.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            safe = safe.replace(/\n/g, '<br>');
            return safe;
        }

        // --- GEMINI API HELPER (ROBUST) ---
        async function callGemini(prompt, isJson = false, systemInstruction = "Eres un mentor experto en SMC Trading.") {
            try {
                const response = await fetch(proxyUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        systemInstruction: { parts: [{ text: systemInstruction }] }
                    })
                });

                if (!response.ok) throw new Error(`Proxy Error: ${response.status}`);

                const data = await response.json();
                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || data.result;

                if (!text) {
                    console.log("Respuesta vacía del Proxy. Usando respuestas simuladas.");
                    return getMockResponse(prompt, isJson);
                }

                return isJson ? JSON.parse(text) : text;

            } catch (error) {
                console.warn("Error en comunicación con Proxy. Usando respuestas simuladas.", error);
                return getMockResponse(prompt, isJson);
            }
        }

        // --- MOCK RESPONSES (FALLBACK) ---
        function getMockResponse(prompt, isJson) {
            const lowerPrompt = prompt.toLowerCase();

            if (isJson) {
                // Mock para Quiz
                return {
                    question: "¿Qué define mejor la fractalidad del mercado?",
                    options: [
                        "Que los precios siempre suben en temporalidades altas",
                        "Que los mismos patrones se repiten en todas las escalas temporales",
                        "Que el mercado es aleatorio y no tiene estructura"
                    ],
                    correctIndex: 1,
                    explanation: "La fractalidad implica auto-similitud: una estructura en D1 se compone de estructuras idénticas en H1, M15, etc."
                };
            }

            // Mock para Chat y Analizador
            if (lowerPrompt.includes("analiza")) {
                if (lowerPrompt.includes("alcista") && lowerPrompt.includes("rompiendo")) {
                    return "**Probabilidad:** Alta\n**Razón:** La alineación de la tendencia mayor alcista con una ruptura en la menor sugiere continuación.";
                } else if (lowerPrompt.includes("rango")) {
                    return "**Probabilidad:** Baja\n**Razón:** Operar dentro de un rango sin definición clara en temporalidades mayores aumenta el riesgo de ruido.";
                }
                return "**Probabilidad:** Media\n**Razón:** Necesito más detalles sobre la estructura de mercado para ser preciso.";
            } else {
                // Chat genérico
                if (lowerPrompt.includes("tiempo")) return "Si tienes poco tiempo, enfócate en **H4 y Diario**. Esto reduce el ruido y te permite operar con calma al final del día.";
                if (lowerPrompt.includes("scalp")) return "El scalping requiere **M1 o M5**, pero exige una disciplina férrea y control emocional superior debido a la velocidad.";
                return "La clave está en alinear las temporalidades. Recuerda: **la temporalidad mayor manda**. ¿Tienes dudas sobre algún gráfico específico?";
            }
        }

        // --- FEATURE 1: CHAT BOT ---
        async function handleChatSubmit(e) {
            e.preventDefault();
            const input = document.getElementById('user-input');
            const message = input.value.trim();
            if (!message) return;

            addMessage(message, 'user');
            input.value = '';
            const loadingId = addLoading('chat-container');

            const systemPrompt = "Eres un mentor experto en trading institucional. Responde de forma concisa (máximo 3 frases) y educativa sobre el tema de temporalidades y fractalidad.";

            try {
                const response = await callGemini(`${systemPrompt}\n\nPregunta del usuario: ${message}`);
                removeElement(loadingId);
                addMessage(response, 'bot');
            } catch (error) {
                removeElement(loadingId);
                addMessage(`Lo siento, hubo un error de conexión: ${error.message}. Verifica tu clave API.`, 'bot');
            }
        }

        function addMessage(text, sender) {
            const container = document.getElementById('chat-container');
            const div = document.createElement('div');
            div.className = `ai-message ${sender}`;
            // Usar sanitizador seguro
            div.innerHTML = safeMarkdown(text);
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        // --- FEATURE 2: ANALYZER ---
        async function handleAnalyzer() {
            const input = document.getElementById('analyzer-input').value;
            if (!input.trim()) return;

            const btn = document.getElementById('analyzer-btn');
            const resultBox = document.getElementById('analyzer-result');

            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="animate-spin w-4 h-4 mr-2" data-lucide="loader"></i> Analizando...';
            lucide.createIcons();
            btn.disabled = true;
            resultBox.classList.add('hidden');

            const prompt = `Analiza este escenario de trading Top-Down: "${input}". 
            Clasifícalo como: "Probabilidad Alta", "Probabilidad Media" o "Baja/Peligroso".
            Dame una razón breve de 1 frase. 
            Formato: 
            **Probabilidad:** [Nivel]
            **Razón:** [Explicación]`;

            try {
                const response = await callGemini(prompt);
                resultBox.innerHTML = safeMarkdown(response).replace(/Probabilidad:/g, '<span class="text-kawn-deep font-bold">Probabilidad:</span>');
                resultBox.classList.remove('hidden');
                resultBox.classList.add('animate-fade-in');
            } catch (error) {
                resultBox.textContent = "Error al analizar. Intenta de nuevo.";
                resultBox.classList.remove('hidden');
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
                lucide.createIcons();
            }
        }

        // --- FEATURE 3: QUIZ GENERATOR ---
        async function handleQuiz() {
            const container = document.getElementById('quiz-container');
            const btn = document.getElementById('quiz-btn');

            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="animate-spin w-4 h-4 mr-2" data-lucide="loader"></i> Generando...';
            lucide.createIcons();
            btn.disabled = true;

            const prompt = `Genera una pregunta de opción múltiple sobre trading (temporalidades, fractalidad o sesiones) en formato JSON.
            Schema: { "question": "string", "options": ["string", "string", "string"], "correctIndex": number, "explanation": "string" }`;

            try {
                const data = await callGemini(prompt, true);

                let optionsHtml = '';
                // Sanitizar datos del quiz antes de renderizar
                const safeExplanation = safeMarkdown(data.explanation).replace(/'/g, "\\'");

                data.options.forEach((opt, index) => {
                    optionsHtml += `<button onclick="checkQuiz(this, ${index}, ${data.correctIndex}, '${safeExplanation}')" class="quiz-option w-full text-left p-3 border border-slate-200 rounded mb-2 cursor-pointer hover:bg-slate-50 transition-colors text-sm focus:outline-none focus:ring-2 focus:ring-kawn-base">${safeMarkdown(opt)}</button>`;
                });

                container.innerHTML = `
                    <div class="animate-fade-in bg-white p-4 rounded-lg border border-slate-200">
                        <p class="font-bold text-slate-800 mb-3 text-sm">${safeMarkdown(data.question)}</p>
                        <div class="mb-2">${optionsHtml}</div>
                        <div id="quiz-feedback" class="text-xs mt-2 hidden p-2 rounded"></div>
                    </div>
                `;
                container.classList.remove('hidden');

            } catch (error) {
                console.error(error);
                container.innerHTML = '<p class="text-red-500 text-xs">Error generando quiz. Revisa tu conexión.</p>';
                container.classList.remove('hidden');
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
                lucide.createIcons();
            }
        }

        function checkQuiz(el, index, correctIndex, explanation) {
            const parent = el.parentElement;
            const options = parent.querySelectorAll('.quiz-option');
            // Deshabilitar botones para evitar múltiples clics
            options.forEach(opt => opt.onclick = null);

            const feedback = document.getElementById('quiz-feedback');

            if (index === correctIndex) {
                el.classList.add('bg-green-100', 'border-green-500', 'text-green-800');
                feedback.innerHTML = `<strong class="text-green-700">¡Correcto!</strong> ${explanation}`;
                feedback.classList.add('bg-green-50');
            } else {
                el.classList.add('bg-red-100', 'border-red-500', 'text-red-800');
                options[correctIndex].classList.add('bg-green-100', 'border-green-500', 'text-green-800');
                feedback.innerHTML = `<strong class="text-red-700">Incorrecto.</strong> ${explanation}`;
                feedback.classList.add('bg-red-50');
            }
            feedback.classList.remove('hidden');
        }

        // --- UTILS ---
        function addLoading(containerId) {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = `ai-message bot typing-indicator`;
            div.innerHTML = '<span></span><span></span><span></span>';
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            div.id = 'loading-' + Date.now();
            return div.id;
        }

        function removeElement(id) {
            const el = document.getElementById(id);
            if (el) el.remove();
        }

        // --- EXISTING CHART/LOGIC (ROBUST INITIALIZATION) ---
        // Envuelto en try/catch para evitar crash si Chart.js no carga
        try {
            const ctx = document.getElementById('zoomChart').getContext('2d');
            const labels = Array.from({ length: 100 }, (_, i) => i);
            function generateData(noiseLevel) {
                return labels.map(x => {
                    const trend = Math.sin(x / 10) * 10;
                    const noise = (Math.random() - 0.5) * noiseLevel;
                    return trend + noise;
                });
            }
            const chart = new Chart(ctx, {
                type: 'line',
                data: { labels: labels, datasets: [{ label: 'Acción del Precio', data: generateData(0), borderColor: '#0f766e', borderWidth: 2, pointRadius: 0, tension: 0.4, fill: true, backgroundColor: 'rgba(20, 184, 166, 0.1)' }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } }, animation: { duration: 0 } }
            });
            document.getElementById('timeframeSlider').addEventListener('input', (e) => {
                const val = parseInt(e.target.value);
                let noise = 0, text = "", color = "";
                if (val < 20) { text = "Mensual (MN)"; noise = 1; color = "#0f766e"; }
                else if (val < 40) { text = "Semanal (W1)"; noise = 5; color = "#14b8a6"; }
                else if (val < 60) { text = "Diario (D1)"; noise = 10; color = "#0ea5e9"; }
                else if (val < 80) { text = "1 Hora (H1)"; noise = 25; color = "#f59e0b"; }
                else { text = "1 Minuto (M1)"; noise = 60; color = "#ef4444"; }
                document.getElementById('zoomLabel').textContent = text;
                chart.data.datasets[0].data = generateData(noise);
                chart.data.datasets[0].borderColor = color;
                chart.update();
            });
        } catch (e) {
            console.error("Error inicializando gráficos:", e);
        }

        // Fractal Logic
        let fractalM5ChartInstance = null;
        function revealFractal(stage) {
            document.querySelectorAll('.fractal-layer').forEach(el => { el.classList.remove('flex'); el.classList.add('hidden'); });
            const target = document.getElementById(`fractal-stage-${stage}`);
            target.classList.remove('hidden'); target.classList.add('flex');
            if (stage === 3) initFractalM5Chart();
        }
        function resetFractal() { revealFractal(1); }
        function initFractalM5Chart() {
            if (fractalM5ChartInstance) fractalM5ChartInstance.destroy();
            const ctxFractal = document.getElementById('fractalM5Chart').getContext('2d');
            const dataM5 = Array.from({ length: 50 }, () => Math.random() * 100);
            fractalM5ChartInstance = new Chart(ctxFractal, { type: 'bar', data: { labels: dataM5.map((_, i) => i), datasets: [{ label: 'Volatilidad M5', data: dataM5, backgroundColor: dataM5.map(v => v > 50 ? '#22c55e' : '#ef4444'), }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } }, animation: { duration: 1000 } } });
        }

        // Candle Simulator
        document.getElementById('candleSlider').addEventListener('input', (e) => {
            const time = parseInt(e.target.value);
            document.getElementById('timer-display').textContent = `Min: ${time.toString().padStart(2, '0')}`;
            const body = document.getElementById('sim-candle-body');
            const wick = document.getElementById('sim-candle-top-wick');
            const narrative = document.getElementById('candle-narrative');
            let height = 0, wickHeight = 0, color = "bg-green-500";

            // Lógica corregida para visualización de mecha
            if (time <= 45) {
                height = (time / 45) * 80; wickHeight = 0;
                narrative.innerHTML = '<strong class="text-green-600 text-lg">¡RUPTURA ALCISTA!</strong><p class="text-sm">Todo parece indicar compras fuertes.</p>';
            } else if (time <= 55) {
                height = 80; wickHeight = (time - 45) * 2;
                narrative.innerHTML = '<strong class="text-yellow-600 text-lg">¿Duda?</strong><p class="text-sm">El precio se detiene...</p>';
            } else {
                const rejection = (time - 55) / 5;
                height = 80 - (rejection * 60);
                // La mecha crece hacia abajo para llenar el espacio dejado por el cuerpo
                // Wick Top = (50% + 80%) = 130 (aprox en coordenadas relativas)
                // Wick Bottom = 50% + height
                wickHeight = 80 - height; // Altura total de la mecha
                if (time === 60) {
                    narrative.innerHTML = '<strong class="text-red-600 text-lg">¡TRAMPA!</strong><p class="text-sm">Pinbar bajista confirmada.</p>'; color = "bg-red-500";
                } else {
                    narrative.innerHTML = '<strong class="text-orange-600 text-lg">¡Reversión!</strong>';
                }
            }
            body.style.height = `${height}%`; body.style.bottom = "50%";
            wick.style.bottom = `${50 + height}%`; wick.style.height = `${wickHeight}%`;
            body.className = `candle-body w-12 absolute bottom-1/2 rounded-sm ${color}`;
            wick.className = `candle-wick w-[2px] absolute ${color}`;
        });

        // Session Monitor
        function setSession(session) {
            const details = document.getElementById('session-details');
            ['asia', 'london', 'ny'].forEach(b => {
                document.getElementById(`btn-${b}`).className = "p-4 rounded-lg border-2 border-slate-600 hover:bg-slate-700 hover:border-blue-400 transition-all text-left group";
                document.getElementById(`btn-${b}`).querySelector('div:first-child').className = "text-xs font-bold text-slate-400 uppercase mb-1 group-hover:text-white";
            });
            const activeBtn = document.getElementById(`btn-${session}`);
            activeBtn.className = "p-4 rounded-lg border-2 border-kawn-base bg-slate-700 shadow-lg shadow-kawn-base/20 transition-all text-left";
            activeBtn.querySelector('div:first-child').className = "text-xs font-bold text-kawn-light uppercase mb-1";
            let content = {
                asia: { t: "Sesión Asiática", d: "Rango y poco volumen.", tf: "M15/H4", p: "AUD, JPY" },
                london: { t: "London Open", d: "Volumen masivo, inicio de tendencias.", tf: "M15/H1", p: "GBP, EUR" },
                ny: { t: "New York", d: "Volatilidad y noticias.", tf: "M1/M5", p: "XAU, US30" }
            }[session];
            // Safe HTML insert
            details.innerHTML = `<h4 class="text-lg font-bold text-kawn-base mb-2 animate-fade-in">${content.t}</h4><p class="text-sm text-slate-300 mb-4 animate-fade-in">${content.d}</p><div class="grid grid-cols-2 gap-4 animate-fade-in"><div class="bg-slate-800 p-3 rounded border border-slate-600"><span class="text-xs font-bold text-slate-400 block mb-1">TF Recomendado</span><span class="text-green-400 font-bold">${content.tf}</span></div><div class="bg-slate-800 p-3 rounded border border-slate-600"><span class="text-xs font-bold text-slate-400 block mb-1">Activos</span><span class="text-blue-300 font-bold">${content.p}</span></div></div>`;
        }

        // Factor Rule & Top Down (Sin cambios lógicos, solo visuales ya correctos)
        function calculateFactor() {
            const base = document.getElementById('baseTimeframe').value;
            const map = { m1: ["M5", "Ticks"], m5: ["M30/H1", "M1"], m15: ["H1", "M5"], h1: ["H4", "M15"], h4: ["D1", "H1"], d1: ["W1", "H4"] };
            const res = map[base];
            document.getElementById('factorResults').innerHTML = `<div class="flex justify-between p-3 bg-blue-50 rounded border border-blue-100"><span class="text-xs font-bold text-blue-800">Tendencia</span><span class="font-bold text-blue-600">${res[0]}</span></div><div class="flex justify-between p-3 bg-kawn-light/30 rounded border border-kawn-base/30"><span class="text-sm font-bold text-kawn-deep">Gatillo</span><span class="font-bold text-kawn-dark uppercase">${base}</span></div><div class="flex justify-between p-3 bg-slate-50 rounded border border-slate-200 opacity-70"><span class="text-xs font-bold text-slate-500">Detalle</span><span class="font-bold text-slate-500">${res[1]}</span></div>`;
        }
        function switchTab(t) { document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden')); document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active')); document.getElementById(`content-${t}`).classList.remove('hidden'); document.getElementById(`btn-${t}`).classList.add('active'); }
        function highlightProfile(p) { document.querySelectorAll('.profile-card').forEach(c => { c.classList.remove('highlight'); c.classList.add('dimmed'); }); const s = document.getElementById(`card-${p}`); s.classList.remove('dimmed'); s.classList.add('highlight'); }
        function calculateTopDown() {
            const h = document.getElementById('sel-htf').value, m = document.getElementById('sel-mtf').value, l = document.getElementById('sel-ltf').value;
            const r = document.getElementById('td-result');
            if (h == 'neutral' || m == 'neutral' || l == 'neutral') { r.innerHTML = '<p class="text-slate-400 italic">Completa los campos...</p>'; r.className = "mt-6 p-4 rounded-lg bg-slate-700/50 border border-slate-600 text-center"; return; }
            if (h == 'bullish' && m == 'pullback' && l == 'pattern') { r.innerHTML = '<strong class="text-green-400 text-lg">★ HIGH PROBABILITY ★</strong>'; r.className = "mt-6 p-4 rounded-lg bg-green-900/50 border border-green-500 text-center"; }
            else { r.innerHTML = '<strong class="text-yellow-300">WAIT / ANALYZE</strong>'; r.className = "mt-6 p-4 rounded-lg bg-yellow-900/30 border border-yellow-700 text-center"; }
        }
    </script>
</body>

</html>